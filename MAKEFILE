#
#  Makefile for IKForth.
#
#  Copyright (C) 1999-2003 Illya Kysil
#

IKForth.img: src\FKernel.exe src\FKernel.img \
             src\*.f src\kernel\*.f src\win32\*.f \
             lib\ansi\*.f lib\~ik\*.f lib\~js\486asm\*.f
      src\FKernel.exe
      copy src\FKernel.exe IKForth.exe

src\FKernel.img: src\image\FKernel.asm src\image\*.inc
      cd  src\image
      wasm -e200 -3ps -mf -bt=nt -d1 FKernel.asm
      wlink file FKernel.obj system nt op map op offset=0 name ..\FKernel.img
      wdis -l=FKernel.lst ..\FKernel.img
      cd  ..\..

src\FKernel.exe: src\loader\*.cpp src\loader\*.hpp
      cd  src\loader\win32
      wmake
      copy FKernel.exe ..\..\FKernel.exe
      cd  ..\..\..

clean: IKForth.img
      del src\image\*.obj
      del src\image\FKernel.lst
      del src\FKernel.img
      del src\FKernel.exe
      cd  src\loader\win32
      wmake clean
      cd  ..\..\..
