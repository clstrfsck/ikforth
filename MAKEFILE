#  Makefile for IKForth.
#
#  Copyright (C) 1999-2003 Illya Kysil
#
#  Usage:   make -B         # IKForth
#           make -B -DDEBUG # IKForth with debug info
#

!if $d(DEBUG)
TASMDEBUG=/zi
LINKDEBUG=/v
!else
TASMDEBUG=
LINKDEBUG=
!endif

IKForth.img: kernel.bin\FKernel.exe kernel.bin\FKernel.img \
             kernel.bin\*.f lib\kernel\*.f lib\ansi\*.f lib\~ik\*.f lib\~js\486asm\*.f lib\win32\*.f
      kernel.bin\FKernel.exe
      copy kernel.bin\FKernel.exe IKForth.exe

kernel.bin\FKernel.img: image\FKernel.asm image\*.inc
      cd image
      tasm32  $(TASMDEBUG) /q/z/la FKernel.asm
      cd ..
      tlink32 $(LINKDEBUG) /x image\FKernel.obj,kernel.bin\FKernel.img

kernel.bin\FKernel.exe: loader\*.pas loader\*.dpr
      cd loader
      dcc32 FKernel.dpr
      cd ..

clean: IKForth.img
      del loader\*.dcu
      del image\*.obj
      del kernel.bin\FKernel.img
      del kernel.bin\FKernel.exe
